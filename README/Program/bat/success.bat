@echo off
%1(start /max powershell.exe /c %0 :&exit)
COLOR 70
title  Congratulations!
echo;                                                                                                    
echo;                                                                                                    
echo;                                                                          ::rXi                     
echo;                                       ::rX2SSS22a22XaSSri.  ,   .,;28BWMMMMMMM                     
echo;                 MMMM@B8ZSri:..    .72a2X7r;;iii;i;i;;rrXSaZMMMMMMMMM@@@@BWBWMM                     
echo;                 MMMMMMMMMMMMMMMWWMM2;:i::i;;;;;i::::;i;ii:i:;X0MMWB0B00BBBBW@M.                    
echo;                 MMMMWWBBBB0B000@M07i:;i:i;i;ii,,,:,:,:,:ii:,,,.:XBM@BBBBBWW@XMi                    
echo;                 7MaWMWWBB00000@8i.,:;i:;;i;i:::::,:::,:,::;i,,i:,.;ZM@WBWBM2rMr                    
echo;                  MZ;ZM@WBB0BBMS.,ii;i:;;i;:,:i::::::,:,:,:,;7,.:ii..rWM@WMWr7Mi                    
echo;                  MM;;X@MWBBBMS :ii;i,i;i;:,:;:i::,:::::,i::,77,,:i;:..aMMMarXM,                    
echo;                  ;MSrr;0MWWMa :ii;;,:ii;i,,iii::,:::::,i::::.2i,::i;i: XMMX7XM                     
echo;                   M8rX7;8MMW ,i;;;i.;:r;:,:;i::::::::::,i:,:.72.:,,i;ii XMSrZB                     
echo;                   8MrXX7;WM; ii;;;.iii;i,,;7:i,:::::,i::::,i:iZi.:::;;ii.XS7BX        .,           
echo;                   rM2;X7rM@ :iii;:,iiir::.Xri:,::::::,::::i:i,2X.,i::;;ii.ZXW       :S;iX7         
echo;                   aMMr7X;MX.i;i;i:.;,;i,,.27::,;i::i:::ii:i:i:XZ,,,;,i;;;:;8W      .a    Xi        
echo;                  7a:MZr778:,ii;;i,:r:i:,,.87i:,;;,::i:::i:i:;:78r.::;,r;;i ZM   ,;iX7    ;B;777    
echo;                  @;,BMXrSa.;i;i;,,,7,;,:,,0X::,Xi,,::::iii::iii@Z,.:;i:;;;.X7;XZXi:XZ    ii   i2   
echo;                 r8;iiMM;2X:i;;;;:,ir:7:,,.BXi.iXi,:::,:i;;i:ii;0ZX,.ii:;;;:i7 77     .rr;      a.  
echo;                 BX;;::MMZr:;;;;i,,;r;X.:.,W2:.;Xi,,::::;iri:irrZ,Z;.:r:i;;::2 :S     77i7r    77   
echo;                 W;r;;::MM,:i;;r:,.7;rX.,,iBZi.XX;,:::,iii;i:;;X2.78,.ii,;;i.a, :7;a7  rii  ;8r:    
echo;                iZi;;;;,2B,i;i;;:,.X;7X.,,ra2;:XXi,,:,:iiiriii;XX  Z2 :i,i;:.Si.  28.        ,S     
echo;                XZ;r;r;;2Z,ii;;;,:,2;XX..:72XX:S7r.:,::;iiii:;iZ;  ,0S X:ii:.2r::XX     B7    :2    
echo;                2S;r;;;iaZ,i;;;::.iZiSS..:XSXZ7a7;:,:,i;ii;:;XX8.   ;Brir,;:.ar,,S,    872ai.,27    
echo;                aSir;;;iSZ,i;;i::.;Z.BS. :Z, ZiXXri,::i;ii::SSX,     SSir,i:.ai  X8:.7M,  ,XXX:     
echo;                aX;;;;;:Xa:i;i::i 72:ZX  XX  ;X:8;;,,i;ii:irX7,       ir7,ii.S: SZMr,rB             
echo;                2Si;i;;i;a:;;;,,:.XS7ZZ,2MZr, 7i8Xi:,i:i;Sarri 2BMMMMMWZS.:i.aB0878  7X             
echo;                X2;;i;riiSii;i,,i.X8ZMWZMMMMMMSrrS7;rrS7rX; .iMMM@@W87r2Z ;:,8M27rW7,Z:             
echo;                iZi;ir;i:Xii;i,:i,r0; S@0880SX ri.rri:;,      WW0088Xa :7,7,iM@X7:;i,7X             
echo;                .Ziii;ri:X;i;:,:i,iZ: 0@BBBB0B; .         .   W0BBW0@Z  ;:X 8@: ,,::, B             
echo;                .Zi;:;;i.Sii;i,i:i,X  ,ZX7XXX8,        . .    ;7i;;;7  :r2i;W. ....:ir8;            
echo;                 Z;iii;i.XXi;:,i:i.7:. ,i...:.  ..... . . . .     ...;7XXS7S7 ,,,,:,.:MS            
echo;                 0i;,ii; 7Xiii,;::XSXXXX:.     . ... . . ... .  ...,:aS7rXXZ, ,:,:,,. Zr            
echo;                 0;i,iii.rS:;:,;;.SS7r;X;.,..   .           ......,,,:X.Xr78 .:,:,:,, 2;            
echo;                 8;;,ii; 7Si;:,i7,,7ri ..,.... .  .i:iiiii:  . .......  X;Z7 ,,,,:,:  Br            
echo;                 Zr;:,ii.X2:r,i:Si,,XXi   . . .  ;8Xr;r;r78,  . ...    7rX8 .,::,,,. 7@             
echo;                 8r;,,ii,22:i:::SX..Xi i,.    .. ;Si:ii;i;7  . .     ;XrrB:.,:,:.,  7M,             
echo;                 0;i:,;,iSZ:;ii,72. ;2            ,.,::,,         :iX0;7Br ,:,,.. ,aW,              
echo;                 Bi;,,;:;XZiiii:,Zi .MBZ7r:.                  ,;2ZS7aXSB7 .,.. .:70B                
echo;                .Z;i,.;:XrZ;;:i:,22  0WWMM0Z88airi;i;::;;72XZZa00r;aZS0; .....irZ87X                
echo;                :8ii,,;rX;Zrii:i:7Zi 7MBS7rXX2Ba;7XX77XW2222ZXr8SXZa:XX    :;72BS: S,               
echo;                r2i:,,;7S;Z7iii::rSa. W7;7XXXrXZS:i;i:aSSXXr2 7ZZXX, a.  ,rrS0BZi :ia               
echo;         ,X0BWX 2r,,.,;27;2X:;:i,rrZZ 7BrXXSXXXXZZr::aZr:,.: ,22Sri ;S irrSB@ZiXX.:.Z:              
echo;       :MMMMMMMMMa,  .7ar;2a,ii::;r2ZS,aa77XX7;iiiX72:  r280i2.7Br. 2X;720@87i;X2,,,;8              
echo;       ,MMM@WWW@@MMZ, ra;rXW:i:i:irZXXSS7 ..  iri7raSrXBB0ZB8  :BX .2XaBWMaii7;72i.i.a7             
echo;        .BMMMM@BWWMMM82;;;7Wr:i:i:7ZX,.rZ8r,iiMWB0B00WM8ZaZ82  .28  B0B8XaB;;r7r2X.,i.0.            
echo;           .rSWM@WBWWMM2,;;WS,ii::r8;   ,X8a7rWBZZaZ0@BM008B@:  ra2 8BZ;irBZi7r7X2,,:i;0            
echo;              S2@M@WBW@Ma,;8B,iii,r0: ,.. .:i ZMaa8WMWiWMW@@@M7 ,ZMSa82iriXMX;rr72;.,::72           
echo;             2Sa;SMWBBW@MX,a@X,;::i0..,,,...  .BMMWW8@ iW0aB@Z . aW88W2irr;BB7;r7X7,,,i:2r          
echo;            7aS8r.2MWBBBMW.SW0::i::a:.,,.:i.,. rM0Z88Mi 7M@0r .. iMZZ0B7rr;S;87r77Xi,,,;iZ:         
echo;           :Z78Mri.W@BBW@M:7@M2,ii,Zi.,.,a:,,, ;00808B;  ;;. .,,  B8ZZZXrr;Zi.0rrX7;:,,:ri8         
echo;          .0r8WW;::W@BWWM@72X;aX:i:27  .8X.,::,   ... .,,  .,,:,, 00ZZ0X;rr7Z i077Xi:::,ir7Z        
echo;          07ZB Zi,aMWWWMM@7.  r8X::rX  2Z,.:,:,,.. . .,,,,,,,,,:. S@aZ00;7rr0; r0777::::.7i2r       
echo;         8X2W  8,2MWW@MMa   ...;8X:.2:SZ7 ,,:,:,:,:,:,:,::,,:,:,, ;MZa8MZrX;Sa  70777.,:,:X:8       
echo;        XZXB  :ZSMWWWMX   .:,,..iZa;.Z2X;.,:,:,,,:,:::,,::,:,:,:, .WZZZ8XaX7;W.  X0rXi.:,,riXX      
echo;       .B70   :MMBB0MS  ,,,,:::...72X7ZX, :,,,:,:,,,,,:,:,:::,::,  80ZZ@ X07;ZX   2Z77,,,.Xa,Z      
echo;       7S0:   ,MWB0@@X .,:,:,:,,  ,28X2Z;i,,,:,::,:,::,::,,:,:,,,, ZBZaM: ZB;X0    ZaXi,:.7M;8.     
echo;       ZaX    XMB0B@X r..,,,,,,  ,2M2rSr.,:,::,,:,:,,,,:i.:::,:,:. 2@aZ@r  MZiW     BXr.i XrX8.     
echo;       Z0:    2M00Wi . i:      .iZMBrXX; ,,:,::,::,:,:.i::,:,,,:,, XWZZM;  ,Mr0:    r8r,i.Z X@      
echo;       ;M     iM@0B08Ba:XX77iirX0BWSrX2i.,,,,,:,:,,,:,,i:,:,:,:,:. 7WaZM;   2Z8:     B;,i7Z Mi      
echo;        0X     ;MM0BBWW@M0.:B0ZB088r7XSi.:,:,:,,,:,:,,:i,,::,,,:,. 7W88M     ZB:     B;7aZ r        
echo;         0X.     WMW00000WWi2MZaZB2rXXS:.,,,:,:::,:,:.;:,,:,:,::: :7BB@Z    .@0   .;BM00X           
echo;          ;;      ;MMMMMMMMMMMMMMMS22aZ;,::i:::::i:i:;r::i:i:i:i,,7a0MM    ,SX     7X;.             
echo;    
ECHO.&ECHO. ※安装完成，若验证失败，请检查密钥是否输入正确，密钥保存在aria2目录下的"secret-token(密钥).txt"。
cd ..\..\..\
echo.您当前的密钥是
type .\"secret-token(密钥).txt"
echo.本机hostname为localhost,默认端口为6800，protocal为websocket或http，请前往ariaNG settings修改rpc设定。
echo.默认rpc地址为http://localhost:6800/jsonrpc
powershell echo "http://token:$(type .\'secret-token(密钥).txt')@localhost:6800/jsonrpc" > .\rpc-address.txt
powershell echo "部分第三方插件使用的rpc地址为$(type .\'rpc-address.txt')"
echo.按任意键退出！※ &PAUSE >NUL 2>NUL&goto exit